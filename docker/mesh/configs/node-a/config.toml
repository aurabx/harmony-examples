# ============================================================================
# Node A Configuration - Mesh Backend Node
# ============================================================================
# This node:
#   - Receives incoming mesh traffic (ingress)
#   - Forwards requests to the Python backend server
#   - Acts as the "destination" in the mesh topology
# ============================================================================

[proxy]
id = "harmony-node-a"
pipelines_path = "pipelines"
primary_provider = "local"

# Provider Configuration
[provider.runbeam]
api = "https://api.runbeam.cloud"
poll_interval_secs = 30

# ============================================================================
# Management API
# ============================================================================
[management]
enabled = true
base_path = "admin"
network = "management"

# ============================================================================
# Networks
# ============================================================================
[network.default]
enable_wireguard = false
interface = "wg0"

[network.default.http]
bind_address = "0.0.0.0"
bind_port = 8080

[network.management]
enable_wireguard = false
interface = "wg0"

[network.management.http]
bind_address = "0.0.0.0"
bind_port = 9090

# ============================================================================
# Logging
# ============================================================================
[logging]
log_level = "debug"
log_to_file = true
log_file_path = "/tmp/harmony/harmony.log"

# ============================================================================
# Storage
# ============================================================================
[storage]
backend = "filesystem"

[storage.options]
path = "/tmp/harmony"

# ============================================================================
# Service Types
# ============================================================================
[services.http]
module = ""

[services.echo]
module = ""

# ============================================================================
# Middleware Types
# ============================================================================
[middleware_types.passthru]
module = ""

[middleware_types.mesh_auth]
module = ""

# ============================================================================
# Mesh Configuration - INGRESS SIDE
# ============================================================================
# Node A defines mesh authentication for incoming requests
# Ingress points are defined in the pipeline under pipelines.{name}.mesh.ingress
# ============================================================================

[mesh.test_mesh]
type = "http"
provider = "local"
auth_type = "jwt"
# Shared secret for mesh JWT authentication (same on both nodes)
jwt_secret = "mesh-test-secret-key-change-in-production"
ingress = ["api_ingress"]
egress = []
description = "Test mesh for Docker networking demo"
enabled = true
