# ==============================================================================
# UCP Checkout Session Complete Pipeline
# ==============================================================================
# Implements UCP checkout session complete operation
# Endpoint: POST /v1/checkout/sessions/{id}/complete
# ==============================================================================

[pipelines.checkout_complete]
network = "http_net"
path = "/v1/checkout/sessions/*/complete"
method = "POST"
backend_ref = "commerce_backend"

middleware = [
    "ucp_to_backend",
    "backend_to_ucp"
]

# ==============================================================================
# MIDDLEWARE DEFINITIONS
# ==============================================================================

[middleware.ucp_to_backend]
type = "transform"

[middleware.ucp_to_backend.options]
spec_path = "mock_backend_order.json"
apply = "left"
fail_on_error = true

[middleware.backend_to_ucp]
type = "transform"

[middleware.backend_to_ucp.options]
spec_path = "order_to_ucp.json"
apply = "right"
fail_on_error = true
