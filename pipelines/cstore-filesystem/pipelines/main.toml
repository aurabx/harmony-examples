[pipelines.dicom_ingest]
description = "Ingest DICOM files to local storage"
networks = ["default"]
endpoints = ["dicom_listener"]
backends = ["filesystem_storage"] 
middleware = []

# Define the DICOM SCP endpoint
[endpoints.dicom_listener]
service = "dicom_scp"
peer_ref = "listener_config"
[endpoints.dicom_listener.options]
local_aet = "HARMONY_SCP"
# Bind address and port are inherited from peer_ref (listener_config)
enable_echo = true
enable_store = true

# Define the filesystem storage backend
[backends.filesystem_storage]
service = "storage"
[backends.filesystem_storage.options]
root = "data/archive"
write_pattern = "{file}"  # Use the 'file' field from the C-STORE payload
